<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Transport of Incident Detection Message Exchange Format version 2 (IDMEFv2) Messages over HTTPS</title>
<meta content="Gilles Lehmann" name="author">
<meta content="
       The Incident Detection Message Exchange Format version 2 (IDMEFv2) defines a
        data representation for security incidents detected on cyber and/or physical
        infrastructures. 
       The format is agnostic so it can be used in standalone or combined cyber
        (SIEM), physical (PSIM) and availability (NMS) monitoring systems. IDMEFv2 can
        also be used to represent man made or natural hazards threats. 
       IDMEFv2 improves situational awareness by facilitating correlation of multiple types
        of events using the same base format thus enabling efficient detection of complex
        and combined cyber and physical attacks and incidents. 
       This document defines a way to transport IDMEFv2 Alerts over HTTPs. 
       If approved this document would obsolete RFC4767. 
    " name="description">
<meta content="xml2rfc 3.27.0" name="generator">
<meta content="RFC4765" name="keyword">
<meta content="IDMEF" name="keyword">
<meta content="draft-lehmann-idmefv2-https-transport-04" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.27.0
    Python 3.9.21
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.5
    lxml 5.3.1
    platformdirs 4.3.6
    pycountry 24.6.1
    pydyf 0.9.0
    PyYAML 6.0.2
    requests 2.32.3
    setuptools 58.1.0
    wcwidth 0.2.13
    weasyprint 61.2
-->
<link href="draft-lehmann-idmefv2-https-transport-04.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necessary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

:root {
  --font-sans: 'Noto Sans', Arial, Helvetica, sans-serif;
  --font-serif: 'Noto Serif', 'Times', 'Times New Roman', serif;
  --font-mono: 'Roboto Mono', Courier, 'Courier New', monospace;
}

@viewport {
  zoom: 1.0;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: var(--font-sans);
  line-height: 1.6;
  scroll-behavior: smooth;
  overflow-wrap: break-word;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
svg[font-family~="serif" i], svg [font-family~="serif" i] {
  font-family: var(--font-serif);
}
svg[font-family~="sans-serif" i], svg [font-family~="sans-serif" i] {
  font-family: var(--font-sans);
}
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  display: table;
  border: none;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre {
  background-color: #f9f9f9;
  font-family: var(--font-mono);
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
blockquote > *:last-child {
  margin-bottom: 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}
.xref {
  overflow-wrap: normal;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    max-width: 100%;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.refSubseries {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: var(--font-sans);
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  .breakable pre {
    break-inside: auto;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The following is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
.sourcecode pre,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .artwork > pre,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: upper-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background slightly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr {
  break-inside: avoid;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottom margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code, dt tt, dt code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the compact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div.sourcecode:first-child,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type:only-child {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body class="xml2rfc">
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">IDMEFv2 - HTTPS Transport</td>
<td class="right">March 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">Lehmann</td>
<td class="center">Expires 2 October 2025</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-lehmann-idmefv2-https-transport-04</dd>
<dt class="label-obsoletes">Obsoletes:</dt>
<dd class="obsoletes">
<a href="https://www.rfc-editor.org/rfc/rfc4767" class="eref">4767</a> (if approved)</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-03-31" class="published">31 March 2025</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2025-10-02">2 October 2025</time></dd>
<dt class="label-authors">Author:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">G. Lehmann</div>
<div class="org">Telecom Sud Paris</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Transport of Incident Detection Message Exchange Format version 2 (IDMEFv2) Messages over HTTPS</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">The Incident Detection Message Exchange Format version 2 (IDMEFv2) defines a
        data representation for security incidents detected on cyber and/or physical
        infrastructures.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">The format is agnostic so it can be used in standalone or combined cyber
        (SIEM), physical (PSIM) and availability (NMS) monitoring systems. IDMEFv2 can
        also be used to represent man made or natural hazards threats.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
<p id="section-abstract-3">IDMEFv2 improves situational awareness by facilitating correlation of multiple types
        of events using the same base format thus enabling efficient detection of complex
        and combined cyber and physical attacks and incidents.<a href="#section-abstract-3" class="pilcrow">¶</a></p>
<p id="section-abstract-4">This document defines a way to transport IDMEFv2 Alerts over HTTPs.<a href="#section-abstract-4" class="pilcrow">¶</a></p>
<p id="section-abstract-5">If approved this document would obsolete RFC4767.<a href="#section-abstract-5" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 2 October 2025.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2025 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-about-the-transmission-prot" class="internal xref">About the transmission protocol</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-normative-sections" class="internal xref">Normative sections</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-transmission-of-idmefv2-mes" class="internal xref">Transmission of IDMEFv2 Messages over HTTPS</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-architecture-overview" class="internal xref">Architecture overview</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-listening-port" class="internal xref">Listening port</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-compatibility-with-https" class="internal xref">Compatibility with HTTP(S)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="auto internal xref">4.4</a>.  <a href="#name-compatibility-with-dns" class="internal xref">Compatibility with DNS</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a href="#section-4.5" class="auto internal xref">4.5</a>.  <a href="#name-compatibility-with-tls" class="internal xref">Compatibility with TLS</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5.2.1">
                    <p id="section-toc.1-1.4.2.5.2.1.1"><a href="#section-4.5.1" class="auto internal xref">4.5.1</a>.  <a href="#name-acceptable-tls-versions" class="internal xref">Acceptable TLS versions</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5.2.2">
                    <p id="section-toc.1-1.4.2.5.2.2.1"><a href="#section-4.5.2" class="auto internal xref">4.5.2</a>.  <a href="#name-acceptable-ciphersuites" class="internal xref">Acceptable ciphersuites</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5.2.3">
                    <p id="section-toc.1-1.4.2.5.2.3.1"><a href="#section-4.5.3" class="auto internal xref">4.5.3</a>.  <a href="#name-authentication" class="internal xref">Authentication</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5.2.4">
                    <p id="section-toc.1-1.4.2.5.2.4.1"><a href="#section-4.5.4" class="auto internal xref">4.5.4</a>.  <a href="#name-certificate-validation" class="internal xref">Certificate validation</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5.2.5">
                    <p id="section-toc.1-1.4.2.5.2.5.1"><a href="#section-4.5.5" class="auto internal xref">4.5.5</a>.  <a href="#name-pki-integration-and-certifi" class="internal xref">PKI integration and certificate issuance</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.6">
                <p id="section-toc.1-1.4.2.6.1"><a href="#section-4.6" class="auto internal xref">4.6</a>.  <a href="#name-locating-the-https-endpoint" class="internal xref">Locating the HTTPS endpoint using DNS</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-the-javascript-object-notat" class="internal xref">The JavaScript Object Notation Serialization Method</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-acknowledgement" class="internal xref">Acknowledgement</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="auto internal xref">9.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="auto internal xref">9.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-http-result-codes" class="internal xref">HTTP Result Codes</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-B" class="auto internal xref">Appendix B</a>.  <a href="#name-transmission-examples" class="internal xref">Transmission examples</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#appendix-B.1" class="auto internal xref">B.1</a>.  <a href="#name-acknowledged-idmefv2-messag" class="internal xref">Acknowledged IDMEFv2 message</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#appendix-B.2" class="auto internal xref">B.2</a>.  <a href="#name-unsupported-serialization-f" class="internal xref">Unsupported serialization format</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.3">
                <p id="section-toc.1-1.11.2.3.1"><a href="#appendix-B.3" class="auto internal xref">B.3</a>.  <a href="#name-content-negotiation-failure" class="internal xref">Content negotiation failure</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-C" class="auto internal xref"></a><a href="#name-authors-address" class="internal xref">Author's Address</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1"><span>[<a href="#RFC-DEV-IDMEFv2" class="cite xref">RFC-DEV-IDMEFv2</a>]</span> defines a model for the purpose of describing
            security alerts and incidents as IDMEF version 2 (IDMEFv2) messages.
            It also defines serialization methods so that IDMEFv2 messages can be
            shared between IDMEFv2 Analyser detecting incidents and IDMEFv2 Manager,
            the management systems that may need to interact with them.<a href="#section-1-1" class="pilcrow">¶</a></p>
<section id="section-1.1">
        <h3 id="name-about-the-transmission-prot">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-about-the-transmission-prot" class="section-name selfRef">About the transmission protocol</a>
        </h3>
<p id="section-1.1-1">IDMEFv2 defines a message format, not a protocol, as the sharing of
                messages is assumed to be out of scope in order to allow Analyzers and
                Managers to exchange and store alerts in a way most suited to their established
                incident-detection processes. However, a protocol specification is required
                so that actual exchanges can take place between the involved programs.
                Defining a common protocol also ensures interoperability between
                otherwise concurrent implementations.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2">This document specifies the transport of IDMEFv2 messages within
                <span>[<a href="#RFC9112" class="cite xref">RFC9112</a>]</span> or <span>[<a href="#RFC9113" class="cite xref">RFC9113</a>]</span> Request and Response
                messages over Transport Layer Security, a.k.a. <span>[<a href="#RFC9110" class="cite xref">RFC9110</a>]</span>.<a href="#section-1.1-2" class="pilcrow">¶</a></p>
<p id="section-1.1-3">This document describes a serialization method for IDMEF messages based on the
                <span>[<a href="#RFC8259" class="cite xref">RFC8259</a>]</span>.<a href="#section-1.1-3" class="pilcrow">¶</a></p>
</section>
</section>
<section id="section-2">
      <h2 id="name-terminology">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
      </h2>
<p id="section-2-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
            "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
            document are to be interpreted as described in <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span>.<a href="#section-2-1" class="pilcrow">¶</a></p>
</section>
<section id="section-3">
      <h2 id="name-normative-sections">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-normative-sections" class="section-name selfRef">Normative sections</a>
      </h2>
<p id="section-3-1">Implementations of IDMEFv2 willing to exchange messages with other
            implementations are REQUIRED to fully implement:<a href="#section-3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-2.1">
          <p id="section-3-2.1.1">The transmission protocol defined in <a href="#protocol" class="auto internal xref">Section 4</a><a href="#section-3-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-2.2">
          <p id="section-3-2.2.1">The JavaScript Object Notation (JSON) serialization method defined
                    in <a href="#serialization_json" class="auto internal xref">Section 5</a><a href="#section-3-2.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
<div id="protocol">
<section id="section-4">
      <h2 id="name-transmission-of-idmefv2-mes">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-transmission-of-idmefv2-mes" class="section-name selfRef">Transmission of IDMEFv2 Messages over HTTPS</a>
      </h2>
<p id="section-4-1">This section specifies the details of the transport of IDMEFv2 messages
            <span>[<a href="#RFC-DEV-IDMEFv2" class="cite xref">RFC-DEV-IDMEFv2</a>]</span> over HTTPS.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2"><span>[<a href="#BCP56" class="cite xref">BCP56</a>]</span> contains a number of important considerations when using
            HTTP for application protocols. These include the size of the payload for
            the application, whether the application will use a web browser, whether the
            protocol should be defined on a port other than the well-known port for HTTP/HTTPS,
            and if the security provided through HTTPS suits the needs of the new application.<a href="#section-4-2" class="pilcrow">¶</a></p>
<p id="section-4-3">It is acknowledged within the scope of these concerns that HTTPS
            is not ideally suited for IDMEFv2 transport, as the former is a client-server
            protocol and the latter a message-exchange protocol; however,
            the ease of implementation over HTTPS outweighs these concerns.<a href="#section-4-3" class="pilcrow">¶</a></p>
<section id="section-4.1">
        <h3 id="name-architecture-overview">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-architecture-overview" class="section-name selfRef">Architecture overview</a>
        </h3>
<p id="section-4.1-1">In the context of this document, it is expected that IDMEFv2 Analyzers will act
                as HTTP clients, while IDMEFv2 Managers act as HTTP servers.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">However, due to external constraints, implementation-specific design decisions, etc.
                these roles may sometimes be switched around. This can be especially true when
                dealing with segmented networks such as demilitarized zones, where the Analyzer
                may be unable to contact its Manager, or for communications which do not rely on
                an Analyzer sending IDMEFv2 messages to a Manager (e.g. for Manager-to-Manager
                communications). Such specific cases are outside the scope of this specification.<a href="#section-4.1-2" class="pilcrow">¶</a></p>
</section>
<section id="section-4.2">
        <h3 id="name-listening-port">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-listening-port" class="section-name selfRef">Listening port</a>
        </h3>
<p id="section-4.2-1">Consistent with <span>[<a href="#BCP56" class="cite xref">BCP56</a>]</span>, compatible system participating in a consortium
                and hosting a server for the purpose  of receiving IDMEFv2 message using this
                specification SHOULD listen for TCP connections on port TBD
                (see  in <a href="#iana" class="auto internal xref">Section 7</a> for more information).<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">The systems MAY be configurable so as to allow listening on ports other than
                the well-known port; this configuration is out of scope for this specification.<a href="#section-4.2-2" class="pilcrow">¶</a></p>
</section>
<section id="section-4.3">
        <h3 id="name-compatibility-with-https">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-compatibility-with-https" class="section-name selfRef">Compatibility with HTTP(S)</a>
        </h3>
<p id="section-4.3-1">The implementations MUST implement all REQUIRED functionality for <span>[<a href="#RFC9112" class="cite xref">RFC9112</a>]</span>.
                The implementations SHOULD implement all REQUIRED functionality for <span>[<a href="#RFC9113" class="cite xref">RFC9113</a>]</span>
                in a TLS context. In particular, the implementations SHOULD support HTTP/2 protocol negociation
                using the <span>[<a href="#RFC7301" class="cite xref">RFC7301</a>]</span> as defined in <span>[<a href="#RFC9113" class="cite xref">RFC9113</a>]</span> ch 3.3.
                The "h2c" protocol (HTTP/2.0 over cleartext) MUST NOT be used.
                HTTP over TLS (also known as HTTPS) is specified in <span>[<a href="#RFC9110" class="cite xref">RFC9110</a>]</span> ch 2.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<p id="section-4.3-2">Each IDMEFv2 message MUST be sent as a separate HTTP Request. However, an implementation
                MAY send multiple HTTP Requests in parallel to achieve higher message throughput.
                This can be done by creating a separate connection to the HTTP server for each request,
                or by using any multiplexing mechanism provided by the underlying protocol (see for example
                <span>[<a href="#RFC9113" class="cite xref">RFC9113</a>]</span> ch 5).<a href="#section-4.3-2" class="pilcrow">¶</a></p>
<p id="section-4.3-3">All IDMEFv2 messages sent in HTTP Requests MUST be sent using the POST method.
                In addition, the Request-URI of such requests SHOULD be set to '/' for interoperability,
                but an implementation MUST also be able to handle alternative paths to cope with situations
                where URI rewriting may be used (e.g. by a reverse proxy server).<a href="#section-4.3-3" class="pilcrow">¶</a></p>
<p id="section-4.3-4">As IDMEFv2 messages MUST be sent using the POST method, a compatible implementation
                SHOULD answer with an appropriate HTTP code (405 Method Not Allowed) to requests made
                using any other method.<a href="#section-4.3-4" class="pilcrow">¶</a></p>
<p id="section-4.3-5">If a request is made to a Request-URI other than the one dedicated to the processing of
                IDMEFv2 messages, the server SHOULD return an appropriate HTTP code (e.g. 404 Not Found).<a href="#section-4.3-5" class="pilcrow">¶</a></p>
<p id="section-4.3-6">The HTTP Request's body MUST be set to the serialized form of the IDMEFv2 message.
                Since an IDMEFv2 message can be serialized in a variety of ways, the 'Content-Type'
                Request header <span>[<a href="#RFC2045" class="cite xref">RFC2045</a>]</span> MUST be set to a media type <span>[<a href="#RFC2046" class="cite xref">RFC2046</a>]</span> that
                reflects the mechanism used to perform the serialization.
                If the server does not support the media type sent by the client, it SHOULD respond
                with an appropriate HTTP code (415 Unsupported Media Type).<a href="#section-4.3-6" class="pilcrow">¶</a></p>
<p id="section-4.3-7">A conforming IDMEFv2 system acting as an HTTP server MUST support content negotiation
                based on the value of the 'Accept' Request header sent by the client.
                If the client does not advertise supported media types (i.e. omits the 'Accept' header),
                the server MUST default to 'application/json' and use the format defined in <span>[<a href="#RFC8259" class="cite xref">RFC8259</a>]</span>
                to build the HTTP response.
                If the server does not support any of the media types advertised by the client, it SHOULD
                respond with an appropriate HTTP code (406 Not Acceptable).<a href="#section-4.3-7" class="pilcrow">¶</a></p>
<p id="section-4.3-8">If the Response does not contain a body, the appropriate HTTP code SHOULD be returned
                to the client (204 No Content). In this case, the 'Content-Type' header can be omitted
                from the HTTP Response entirely.<a href="#section-4.3-8" class="pilcrow">¶</a></p>
<p id="section-4.3-9">To improve compatibility between implementations, it is RECOMMENDED that all IDMEFv2
                systems conforming to this document support the JSON serialization format defined in
                <span>[<a href="#RFC-DEV-IDMEFv2" class="cite xref">RFC-DEV-IDMEFv2</a>]</span>, with a media type set to 'application/json'.<a href="#section-4.3-9" class="pilcrow">¶</a></p>
<p id="section-4.3-10">If an IDMEFv2 system receives an improper IDMEFv2 message in an HTTP Request,
                it MUST return an appropriate 4xx Client Error result code to the
                requesting system (e.g. 400 Bad Request).<a href="#section-4.3-10" class="pilcrow">¶</a></p>
<p id="section-4.3-11">The HTTP code serves as an acknowledgment of the message. The receiving IDMEFv2 system
                SHOULD NOT confirm acceptance of a message (2xx) unless it managed to safely deal with it,
                e.g. by saving the message to disk / in a database, or by relaying it to another
                system that successfully acknowledged it for further processing.<a href="#section-4.3-11" class="pilcrow">¶</a></p>
<p id="section-4.3-12">If an IDMEFv2 implementation cannot process an IDMEFv2 message
                received in an HTTP Request due to an error on its own side, it MUST
                return an appropriate 5xx Server Error result code to the requesting
                system.<a href="#section-4.3-12" class="pilcrow">¶</a></p>
<p id="section-4.3-13">Note that HTTP provides no mechanism for signaling to a server that a
                Response body is not a valid IDMEFv2 response. If an IDMEFv2 system
                receives an improper HTTP Response, or cannot process an HTTP Response
                due to an error on its own side, it MUST log the error and present it
                to the IDMEFv2 system administrator for handling; the error logging
                format is considered an implementation detail and is out of scope
                for this specification.<a href="#section-4.3-13" class="pilcrow">¶</a></p>
<p id="section-4.3-14"><a href="#appendix-http-codes" class="auto internal xref">Appendix A</a> provides informative guidance on how
                to map various error conditions to an appropriate HTTP result code.<a href="#section-4.3-14" class="pilcrow">¶</a></p>
<p id="section-4.3-15">IDMEFv2 systems relying on HTTP/1.1 MUST support and SHOULD use HTTP/1.1
                persistent connections as described in <span>[<a href="#RFC9112" class="cite xref">RFC9112</a>]</span>.
                IDMEFv2 systems MUST support chunked transfer encoding on the HTTP
                server side to allow the implementation of clients that do not need
                to pre-calculate message sizes before constructing HTTP headers.<a href="#section-4.3-15" class="pilcrow">¶</a></p>
</section>
<section id="section-4.4">
        <h3 id="name-compatibility-with-dns">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-compatibility-with-dns" class="section-name selfRef">Compatibility with DNS</a>
        </h3>
<p id="section-4.4-1">The use of stable DNS names to address IDMEFv2 systems is RECOMMENDED;
                this facilitates connection to IDMEFv2 systems within a consortium.
                The protocol provides no in-band method for handling a change of address
                of an IDMEFv2 system.<a href="#section-4.4-1" class="pilcrow">¶</a></p>
</section>
<section id="section-4.5">
        <h3 id="name-compatibility-with-tls">
<a href="#section-4.5" class="section-number selfRef">4.5. </a><a href="#name-compatibility-with-tls" class="section-name selfRef">Compatibility with TLS</a>
        </h3>
<section id="section-4.5.1">
          <h4 id="name-acceptable-tls-versions">
<a href="#section-4.5.1" class="section-number selfRef">4.5.1. </a><a href="#name-acceptable-tls-versions" class="section-name selfRef">Acceptable TLS versions</a>
          </h4>
<p id="section-4.5.1-1">IDMEFv2 systems SHOULD use TLS version 1.3 <span>[<a href="#RFC8446" class="cite xref">RFC8446</a>]</span> or higher for
                    confidentiality, identification, and authentication, when sending IDMEFv2
                    messages over HTTPS.<a href="#section-4.5.1-1" class="pilcrow">¶</a></p>
<p id="section-4.5.1-2">IDMEFv2 systems MUST NOT request, offer, or use any version of SSL,
                    or any version of TLS prior to 1.3, due to known weaknesses in these
                    protocols; see <span>[<a href="#RFC8446" class="cite xref">RFC8446</a>]</span> ch E for more information.<a href="#section-4.5.1-2" class="pilcrow">¶</a></p>
</section>
<section id="section-4.5.2">
          <h4 id="name-acceptable-ciphersuites">
<a href="#section-4.5.2" class="section-number selfRef">4.5.2. </a><a href="#name-acceptable-ciphersuites" class="section-name selfRef">Acceptable ciphersuites</a>
          </h4>
<p id="section-4.5.2-1">The TLS session MUST use non-NULL ciphersuites for authentication, integrity,
                    and confidentiality. IDMEFv2 systems MUST NOT use ciphersuites with known
                    vulnerabilities and MUST use ciphersuites that provide Perfect Forward
                    Secrecy to protect the messages' confidentiality in case a vulnerability
                    is later discovered in the ciphersuites.<a href="#section-4.5.2-1" class="pilcrow">¶</a></p>
<p id="section-4.5.2-2">Administrators can find guidance regarding the selection of acceptable
                    ciphersuites for TLS version 1.2 in <span>[<a href="#BCP195" class="cite xref">BCP195</a>]</span>.<a href="#section-4.5.2-2" class="pilcrow">¶</a></p>
</section>
<section id="section-4.5.3">
          <h4 id="name-authentication">
<a href="#section-4.5.3" class="section-number selfRef">4.5.3. </a><a href="#name-authentication" class="section-name selfRef">Authentication</a>
          </h4>
<p id="section-4.5.3-1">IDMEFv2 systems MUST use mutual authentication; that is, both IDMEFv2 systems
                    acting as HTTPS clients and IDMEFv2 systems acting as HTTPS servers MUST
                    be identified by an X.509 certificate <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>.
                    Mutual authentication requires full path validation on each certificate,
                    as defined in <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>.<a href="#section-4.5.3-1" class="pilcrow">¶</a></p>
<p id="section-4.5.3-2">All IDMEFv2 systems SHOULD be identified by a certificate containing a
                    DNS-ID identifier as in <span>[<a href="#RFC6125" class="cite xref">RFC6125</a>]</span> ch 6.4; Common Names (CN-IDs)
                    MUST NOT be included in certificates identifying IDMEFv2 systems.<a href="#section-4.5.3-2" class="pilcrow">¶</a></p>
</section>
<section id="section-4.5.4">
          <h4 id="name-certificate-validation">
<a href="#section-4.5.4" class="section-number selfRef">4.5.4. </a><a href="#name-certificate-validation" class="section-name selfRef">Certificate validation</a>
          </h4>
<p id="section-4.5.4-1">IDMEFv2 systems MUST verify the reference identifiers of their peers against those
                    stored in the certificates presented using the methods defined in <span>[<a href="#RFC6125" class="cite xref">RFC6125</a>]</span>.
                    In addition, the following IDMEFv2-specific considerations apply:<a href="#section-4.5.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.5.4-2.1">
              <p id="section-4.5.4-2.1.1">Wildcards MUST NOT appear in the DNS-ID of a certificate identifying an IDMEFv2
                            system. If such a certificate is received by an IDMEFv2 system, the verification
                            MUST fail and the receiving IDMEFv2 system MUST close the connection.<a href="#section-4.5.4-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.5.4-2.2">
              <p id="section-4.5.4-2.2.1">An IDMEFv2 system MAY match the DNS-ID with a reverse DNS lookup of the connecting
                            IDMEFv2 peer; this support SHOULD allow the lookup to be cached and/or done
                            in advance in order to ensure verifiability during instability or compromise
                            of DNS itself.<a href="#section-4.5.4-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.5.4-2.3">
              <p id="section-4.5.4-2.3.1">IDMEFv2 systems MUST support the verification of certificates against an
                            explicit list of approved peer certificates.<a href="#section-4.5.4-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.5.4-2.4">
              <p id="section-4.5.4-2.4.1">IDMEFv2 systems MAY apply additional security measures such as IP filtering
                            to further restrict the list of authorized peers.
                            Such additional defenses are outside of the scope of this specification.<a href="#section-4.5.4-2.4.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
<section id="section-4.5.5">
          <h4 id="name-pki-integration-and-certifi">
<a href="#section-4.5.5" class="section-number selfRef">4.5.5. </a><a href="#name-pki-integration-and-certifi" class="section-name selfRef">PKI integration and certificate issuance</a>
          </h4>
<p id="section-4.5.5-1">This document makes no provision on whether the security consortium implementing
                    IDMEFv2 is responsible or not for issuing the certificates used by the systems.<a href="#section-4.5.5-1" class="pilcrow">¶</a></p>
<p id="section-4.5.5-2">In a PKIX certificate to be presented by an IDMEFv2 system, the certificate
                    MUST include one or more identifiers associated with the IDMEFv2 system.<a href="#section-4.5.5-2" class="pilcrow">¶</a></p>
<p id="section-4.5.5-3">The following IDMEFv2-specific considerations apply:<a href="#section-4.5.5-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.5.5-4.1">
              <p id="section-4.5.5-4.1.1">Support for the DNS-ID identifier type <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span> is REQUIRED
                            in both IDMEFv2 Analyzers and Managers. Certification authorities that issue
                            IDMEFv2-specific certificates MUST support the DNS-ID identifier type.
                            IDMEFv2 service providers SHOULD include the DNS-ID identifier type
                            in certificate requests.<a href="#section-4.5.5-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.5.5-4.2">
              <p id="section-4.5.5-4.2.1">Support for the SRV-ID identifier type <span>[<a href="#RFC4985" class="cite xref">RFC4985</a>]</span> is REQUIRED
                            in both IDMEFv2 Analyzers and Managers implementations using the "_idmef"
                            application service type.
                            Certificate authorities that issue IDMEFv2-specific certificates
                            SHOULD support the SRV-ID identifier type. IDMEFv2 service providers SHOULD
                            include the SRV-ID identifier type in certificate requests.<a href="#section-4.5.5-4.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.5.5-4.3">
              <p id="section-4.5.5-4.3.1">Support for the URI-ID identifier type (<span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span> and <span>[<a href="#RFC3986" class="cite xref">RFC3986</a>]</span>)
                            is OPTIONAL for both IDMEFv2 Analyzers and Managers.
                            Certification authorities that issue IDMEFv2-specific certificates SHOULD
                            support the URI-ID identifier type. IDMEFv2 service providers MAY include
                            the URI-ID identifier type in certificate requests.<a href="#section-4.5.5-4.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.5.5-4.4">
              <p id="section-4.5.5-4.4.1">Support for the CN-ID identifier type <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span> is discouraged.
                            Certification authorities that issue IDMEFv2-specific certificates SHOULD NOT
                            support the CN-ID identifier type. IDMEFv2 service providers MUST NOT include
                            the CN-ID identifier type in certificate requests.<a href="#section-4.5.5-4.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.5.5-4.5">
              <p id="section-4.5.5-4.5.1">DNS domain names in IDMEFv2-specific certificates MUST NOT contain
                            the wildcard character '*'. Certification authorities that issue
                            IDMEFv2-specific certificates MUST refuse to issue certificates
                            containing a wildcard character.<a href="#section-4.5.5-4.5.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.5.5-5">Great care must be taken by administrators when selecting the PKI to use,
                    as trusting a rogue PKI could have dramatic results on the integrity,
                    confidentiality and authentication mechanisms provided by TLS; and hence,
                    result in the compromise of the protocol defined in this specification.<a href="#section-4.5.5-5" class="pilcrow">¶</a></p>
</section>
</section>
<section id="section-4.6">
        <h3 id="name-locating-the-https-endpoint">
<a href="#section-4.6" class="section-number selfRef">4.6. </a><a href="#name-locating-the-https-endpoint" class="section-name selfRef">Locating the HTTPS endpoint using DNS</a>
        </h3>
<p id="section-4.6-1">Information about an organization's IDMEFv2 over HTTPS endpoint's location
                may be stored using DNS Service Location Records (SRV) <span>[<a href="#RFC2782" class="cite xref">RFC2782</a>]</span>.
                The data in a SRV record contains the DNS name of the server that provides
                the IDMEFv2 over HTTPS server, the corresponding Port number, and parameters
                that enable the client to choose an appropriate server from multiple servers
                according to the algorithm described in <span>[<a href="#RFC2782" class="cite xref">RFC2782</a>]</span>.
                The name of this record has the following format:<a href="#section-4.6-1" class="pilcrow">¶</a></p>
<div class="lang-none sourcecode" id="section-4.6-2">
<pre>_&lt;Service&gt;._&lt;Proto&gt;.&lt;Domain&gt;</pre><a href="#section-4.6-2" class="pilcrow">¶</a>
</div>
<p id="section-4.6-3">where &lt;Service&gt; is always "idmef", and &lt;Proto&gt; is always "tcp".
                &lt;Domain&gt; is the domain name of the entity exposing the endpoint.
                Note that "idmef" is the symbolic name for the IDMEFv2 over HTTPS
                service in Assigned Numbers <span>[<a href="#RFC3232" class="cite xref">RFC3232</a>]</span>, as required by
                <span>[<a href="#RFC2782" class="cite xref">RFC2782</a>]</span>.<a href="#section-4.6-3" class="pilcrow">¶</a></p>
<p id="section-4.6-4">Presence of such records enables clients to find the IDMEFv2 over HTTPS
                endpoints using standard DNS query. An IDMEFv2 system seeking the
                endpoint for a particular entity, does a SRV record query using the DNS
                name formed as described in the preceding paragraph, and interprets
                the response as described in <span>[<a href="#RFC2782" class="cite xref">RFC2782</a>]</span> to determine a host
                (or set of hosts) to contact. As an example, a client that searches
                for the IDMEFv2 over HTTPS endpoint for "example.net" will submit a
                DNS query for a set of SRV records with owner name:<a href="#section-4.6-4" class="pilcrow">¶</a></p>
<div class="lang-none sourcecode" id="section-4.6-5">
<pre>_idmef._tcp.example.net.</pre><a href="#section-4.6-5" class="pilcrow">¶</a>
</div>
<p id="section-4.6-6">The requesting system will receive the list of SRV records published
                in DNS that satisfy the requested criteria. The following is an example of
                such a record:<a href="#section-4.6-6" class="pilcrow">¶</a></p>
<div class="lang-none sourcecode" id="section-4.6-7">
<pre>_idmef._tcp.example.net.  IN  SRV  0  0  TBD  soc.example.net.</pre><a href="#section-4.6-7" class="pilcrow">¶</a>
</div>
<p id="section-4.6-8">The set of returned records may contain multiple records in the case
                where multiple servers can act as endpoints for the same domain.
                If there are no matching SRV records available for the domain name,
                the client SHOULD NOT attempt to 'walk the tree' by removing the least
                significant portion of the constructed fully qualified domain name.<a href="#section-4.6-8" class="pilcrow">¶</a></p>
</section>
</section>
</div>
<div id="serialization_json">
<section id="section-5">
      <h2 id="name-the-javascript-object-notat">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-the-javascript-object-notat" class="section-name selfRef">The JavaScript Object Notation Serialization Method</a>
      </h2>
<p id="section-5-1">This serialization method aims to convert IDMEFv2 messages to a format that
            is easy to parse and process, both by software/hardware processors, as well
            as humans.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">It relies on the the JavaScript Object Notation (JSON) Data Interchange Format
            defined in <span>[<a href="#RFC8259" class="cite xref">RFC8259</a>]</span>.<a href="#section-5-2" class="pilcrow">¶</a></p>
<p id="section-5-3">Conforming implementations MUST implement all the requirements specified
            in <span>[<a href="#RFC8259" class="cite xref">RFC8259</a>]</span>.<a href="#section-5-3" class="pilcrow">¶</a></p>
<p id="section-5-4">In addition, the following rules MUST be observed when serializing an IDMEFv2
            message:<a href="#section-5-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-5.1">
          <p id="section-5-5.1.1">The top-level Alert class (<span>[<a href="#RFC-DEV-IDMEFv2" class="cite xref">RFC-DEV-IDMEFv2</a>]</span> ch 4.2) is represented
                    as a JSON object (<span>[<a href="#RFC8259" class="cite xref">RFC8259</a>]</span> ch 4). This JSON object is returned
                    to the calling process at the end of the serialization process.<a href="#section-5-5.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-5.2">
          <p id="section-5-5.2.1">Aggregate classes are represented as JSON objects and stored as members
                    of the top-level JSON object, using the same name as in the IDMEF data model.
                    E.g. the Analyzer aggregate class (<span>[<a href="#RFC-DEV-IDMEFv2" class="cite xref">RFC-DEV-IDMEFv2</a>]</span> ch 4.3) appears
                    under the name "Analyzer" inside the top-level JSON object.<a href="#section-5-5.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-5.3">
          <p id="section-5-5.3.1">Attributes are stored as members of the JSON object representing the class
                    they belong to, using the same name as in the IDMEF data model.
                    E.g. the "Version" attribute of the Alert class is stored under the name
                    "Version" inside the top-level JSON object.<a href="#section-5-5.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-5.4">
          <p id="section-5-5.4.1">Lists from the IDMEF data model are represented as JSON arrays
                    (<span>[<a href="#RFC8259" class="cite xref">RFC8259</a>]</span> ch 5). This also applies to aggregate classes
                    where a list is expected.
                    E.g. the "Sensor" member inside the top-level JSON object
                    contains a list of objects, where each object represents an instance
                    of the Sensor aggregate class (<span>[<a href="#RFC-DEV-IDMEFv2" class="cite xref">RFC-DEV-IDMEFv2</a>]</span> ch 4.4).<a href="#section-5-5.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-5.5">
          <p id="section-5-5.5.1">The various string-based data types listed in <span>[<a href="#RFC-DEV-IDMEFv2" class="cite xref">RFC-DEV-IDMEFv2</a>]</span> ch 3.3
                    are represented as JSON strings (<span>[<a href="#RFC8259" class="cite xref">RFC8259</a>]</span> ch 7).
                    Please note that the issues outlined in <span>[<a href="#RFC8259" class="cite xref">RFC8259</a>]</span> ch 8
                    regarding strings processing also apply here.<a href="#section-5-5.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-5.6">
          <p id="section-5-5.6.1">Since JSON does not provide a way to distinguish between an integer
                    value and a floating-point (decimal) value, IDMEF attributes with
                    the "INT" and "FLOAT" type annotations are both represented
                    as JSON numbers (<span>[<a href="#RFC8259" class="cite xref">RFC8259</a>]</span> ch 6).<a href="#section-5-5.6.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<section id="section-6">
      <h2 id="name-security-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-6-1">Most of the content in <a href="#protocol" class="auto internal xref">Section 4</a> deals with security considerations.
            Great care has been taken to protect the confidentiality, authentification
            and integrity of IDMEFv2 messages while in transit.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">In addition, to the requirements set in <a href="#protocol" class="auto internal xref">Section 4</a>, all security considerations
            of related documents apply, especially the Incident Detection Message Exchange
            Format version 2 <span>[<a href="#RFC-DEV-IDMEFv2" class="cite xref">RFC-DEV-IDMEFv2</a>]</span>. Implementations should also be aware
            of known attacks against Transport Layer Security (TLS) and Datagram TLS (DTLS),
            and how to mitigate them <span>[<a href="#RFC7457" class="cite xref">RFC7457</a>]</span>.<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">Specific considerations have been taken into account regarding certificates usage:<a href="#section-6-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6-4.1">
          <p id="section-6-4.1.1">Use of the wildcard character inside certificates lacks clear specifications
                    and consistency across application technologies. Considering the issues outlined
                    in <span>[<a href="#RFC6125" class="cite xref">RFC6125</a>]</span> ch 7.2 regarding such certificates, the use of wildcard
                    characters inside certificates is explicitly prohibited in this document.<a href="#section-6-4.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-6-4.2">
          <p id="section-6-4.2.1">Use of the Common Name field (CN-ID) has been deprecated for a long time
                    (<span>[<a href="#RFC9110" class="cite xref">RFC9110</a>]</span> ch 3.1). Moreover, this field does not cope well
                    with multiple identifiers (<span>[<a href="#RFC6125" class="cite xref">RFC6125</a>]</span> ch 7.4).
                    As such, this document explicitly prohibits the use of CN-IDs altogether.<a href="#section-6-4.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-6-5">IDMEFv2 systems MAY implement additional security measures (e.g. confidentiality
            and integrity of specific data inside the message at the field's level).
            Such additions SHOULD be designed with interoperability in mind, so that
            implementations that do not recognize these extensions can still process IDMEFv2
            messages in a reasonable manner without degrading the security provided by these
            additions (e.g. by omitting the additions entirely when passing the message to
            another system, or by handling them as opaque data).
            The design of such measures is outside the scope of this document.<a href="#section-6-5" class="pilcrow">¶</a></p>
</section>
<div id="iana">
<section id="section-7">
      <h2 id="name-iana-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-7-1">Consistent with <span>[<a href="#BCP56" class="cite xref">BCP56</a>]</span>, since IDMEFv2 over HTTP/TLS is a
            substantially new service, and should be controlled at the consortium
            member network's border differently than HTTP/TLS, it requires a new
            port number.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">IANA will assigned port TBD/tcp to IDMEFv2 over HTTP/TLS
            with service name "IDMEFv2".<a href="#section-7-2" class="pilcrow">¶</a></p>
<p id="section-7-3">Registration template:<a href="#section-7-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7-4.1">
          <p id="section-7-4.1.1">Service Name: IDMEFv2<a href="#section-7-4.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-7-4.2">
          <p id="section-7-4.2.1">Transport Protocol: TCP<a href="#section-7-4.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-7-4.3">
          <p id="section-7-4.3.1">Assignee: Telecom SudParis<a href="#section-7-4.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-7-4.4">
          <p id="section-7-4.4.1">Contact: Telecom SudParis ( Herve.Debar @telecom-sudparis.eu )<a href="#section-7-4.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-7-4.5">
          <p id="section-7-4.5.1">Description: Transport of Incident Detection Message Exchange Format version
                    2 (IDMEFv2) Messages over HTTPS<a href="#section-7-4.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-7-4.6">
          <p id="section-7-4.6.1">Reference: TBD<a href="#section-7-4.6.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-7-4.7">
          <p id="section-7-4.7.1">Port Number: TBD<a href="#section-7-4.7.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<section id="section-8">
      <h2 id="name-acknowledgement">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-acknowledgement" class="section-name selfRef">Acknowledgement</a>
      </h2>
<p id="section-8-1">The following groups and individuals contributed to the creation of this document and should be recognized for their efforts.<a href="#section-8-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8-2.1">
          <p id="section-8-2.1.1">Thomas Andrejak &amp; François Poirotte (Co-authors of the first version of this document)<a href="#section-8-2.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
<section id="section-9">
      <h2 id="name-references">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-9.1">
        <h3 id="name-normative-references">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC-DEV-IDMEFv2">[RFC-DEV-IDMEFv2]</dt>
        <dd>
<span class="refAuthor">Lehmann, G.</span>, <span class="refTitle">"The Incident Detection Message Exchange Format (IDMEF) version 2"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-lehmann-idmefv2-01</span>, <time datetime="2025-03-31" class="refDate">31 March 2025</time>, <span>&lt;<a href="https://github.com/IDMEFv2/">https://github.com/IDMEFv2/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9112">[RFC9112]</dt>
        <dd>
<span class="refAuthor">Fielding, R., Ed.</span>, <span class="refAuthor">Nottingham, M., Ed.</span>, and <span class="refAuthor">J. Reschke, Ed.</span>, <span class="refTitle">"HTTP/1.1"</span>, <span class="seriesInfo">STD 99</span>, <span class="seriesInfo">RFC 9112</span>, <span class="seriesInfo">DOI 10.17487/RFC9112</span>, <time datetime="2022-06" class="refDate">June 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9112">https://www.rfc-editor.org/info/rfc9112</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3986">[RFC3986]</dt>
        <dd>
<span class="refAuthor">Berners-Lee, T.</span>, <span class="refAuthor">Fielding, R.</span>, and <span class="refAuthor">L. Masinter</span>, <span class="refTitle">"Uniform Resource Identifier (URI): Generic Syntax"</span>, <span class="seriesInfo">STD 66</span>, <span class="seriesInfo">RFC 3986</span>, <span class="seriesInfo">DOI 10.17487/RFC3986</span>, <time datetime="2005-01" class="refDate">January 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3986">https://www.rfc-editor.org/info/rfc3986</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9113">[RFC9113]</dt>
        <dd>
<span class="refAuthor">Thomson, M., Ed.</span> and <span class="refAuthor">C. Benfield, Ed.</span>, <span class="refTitle">"HTTP/2"</span>, <span class="seriesInfo">RFC 9113</span>, <span class="seriesInfo">DOI 10.17487/RFC9113</span>, <time datetime="2022-06" class="refDate">June 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9113">https://www.rfc-editor.org/info/rfc9113</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9110">[RFC9110]</dt>
        <dd>
<span class="refAuthor">Fielding, R., Ed.</span>, <span class="refAuthor">Nottingham, M., Ed.</span>, and <span class="refAuthor">J. Reschke, Ed.</span>, <span class="refTitle">"HTTP Semantics"</span>, <span class="seriesInfo">STD 97</span>, <span class="seriesInfo">RFC 9110</span>, <span class="seriesInfo">DOI 10.17487/RFC9110</span>, <time datetime="2022-06" class="refDate">June 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9110">https://www.rfc-editor.org/info/rfc9110</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8446">[RFC8446]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8446">https://www.rfc-editor.org/info/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5280">[RFC5280]</dt>
        <dd>
<span class="refAuthor">Cooper, D.</span>, <span class="refAuthor">Santesson, S.</span>, <span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Boeyen, S.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">W. Polk</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 5280</span>, <span class="seriesInfo">DOI 10.17487/RFC5280</span>, <time datetime="2008-05" class="refDate">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5280">https://www.rfc-editor.org/info/rfc5280</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4985">[RFC4985]</dt>
        <dd>
<span class="refAuthor">Santesson, S.</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Subject Alternative Name for Expression of Service Name"</span>, <span class="seriesInfo">RFC 4985</span>, <span class="seriesInfo">DOI 10.17487/RFC4985</span>, <time datetime="2007-08" class="refDate">August 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4985">https://www.rfc-editor.org/info/rfc4985</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6125">[RFC6125]</dt>
        <dd>
<span class="refAuthor">Saint-Andre, P.</span> and <span class="refAuthor">J. Hodges</span>, <span class="refTitle">"Representation and Verification of Domain-Based Application Service Identity within Internet Public Key Infrastructure Using X.509 (PKIX) Certificates in the Context of Transport Layer Security (TLS)"</span>, <span class="seriesInfo">RFC 6125</span>, <span class="seriesInfo">DOI 10.17487/RFC6125</span>, <time datetime="2011-03" class="refDate">March 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6125">https://www.rfc-editor.org/info/rfc6125</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8259">[RFC8259]</dt>
      <dd>
<span class="refAuthor">Bray, T., Ed.</span>, <span class="refTitle">"The JavaScript Object Notation (JSON) Data Interchange Format"</span>, <span class="seriesInfo">STD 90</span>, <span class="seriesInfo">RFC 8259</span>, <span class="seriesInfo">DOI 10.17487/RFC8259</span>, <time datetime="2017-12" class="refDate">December 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8259">https://www.rfc-editor.org/info/rfc8259</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-9.2">
        <h3 id="name-informative-references">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="RFC3232">[RFC3232]</dt>
        <dd>
<span class="refAuthor">Reynolds, J., Ed.</span>, <span class="refTitle">"Assigned Numbers: RFC 1700 is Replaced by an On-line Database"</span>, <span class="seriesInfo">RFC 3232</span>, <span class="seriesInfo">DOI 10.17487/RFC3232</span>, <time datetime="2002-01" class="refDate">January 2002</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3232">https://www.rfc-editor.org/info/rfc3232</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2045">[RFC2045]</dt>
        <dd>
<span class="refAuthor">Freed, N.</span> and <span class="refAuthor">N. Borenstein</span>, <span class="refTitle">"Multipurpose Internet Mail Extensions (MIME) Part One: Format of Internet Message Bodies"</span>, <span class="seriesInfo">RFC 2045</span>, <span class="seriesInfo">DOI 10.17487/RFC2045</span>, <time datetime="1996-11" class="refDate">November 1996</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2045">https://www.rfc-editor.org/info/rfc2045</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2046">[RFC2046]</dt>
        <dd>
<span class="refAuthor">Freed, N.</span> and <span class="refAuthor">N. Borenstein</span>, <span class="refTitle">"Multipurpose Internet Mail Extensions (MIME) Part Two: Media Types"</span>, <span class="seriesInfo">RFC 2046</span>, <span class="seriesInfo">DOI 10.17487/RFC2046</span>, <time datetime="1996-11" class="refDate">November 1996</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2046">https://www.rfc-editor.org/info/rfc2046</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2782">[RFC2782]</dt>
        <dd>
<span class="refAuthor">Gulbrandsen, A.</span>, <span class="refAuthor">Vixie, P.</span>, and <span class="refAuthor">L. Esibov</span>, <span class="refTitle">"A DNS RR for specifying the location of services (DNS SRV)"</span>, <span class="seriesInfo">RFC 2782</span>, <span class="seriesInfo">DOI 10.17487/RFC2782</span>, <time datetime="2000-02" class="refDate">February 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2782">https://www.rfc-editor.org/info/rfc2782</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7301">[RFC7301]</dt>
        <dd>
<span class="refAuthor">Friedl, S.</span>, <span class="refAuthor">Popov, A.</span>, <span class="refAuthor">Langley, A.</span>, and <span class="refAuthor">E. Stephan</span>, <span class="refTitle">"Transport Layer Security (TLS) Application-Layer Protocol Negotiation Extension"</span>, <span class="seriesInfo">RFC 7301</span>, <span class="seriesInfo">DOI 10.17487/RFC7301</span>, <time datetime="2014-07" class="refDate">July 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7301">https://www.rfc-editor.org/info/rfc7301</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7457">[RFC7457]</dt>
        <dd>
<span class="refAuthor">Sheffer, Y.</span>, <span class="refAuthor">Holz, R.</span>, and <span class="refAuthor">P. Saint-Andre</span>, <span class="refTitle">"Summarizing Known Attacks on Transport Layer Security (TLS) and Datagram TLS (DTLS)"</span>, <span class="seriesInfo">RFC 7457</span>, <span class="seriesInfo">DOI 10.17487/RFC7457</span>, <time datetime="2015-02" class="refDate">February 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7457">https://www.rfc-editor.org/info/rfc7457</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="BCP56">[BCP56]</dt>
        <dd>
<div class="refInstance">Best Current Practice 56, <span>&lt;<a href="https://www.rfc-editor.org/info/bcp56">https://www.rfc-editor.org/info/bcp56</a>&gt;</span>.<br><span>At the time of writing, this BCP comprises the following:</span>
</div>
<div class="refInstance" id="RFC9205">
            <span class="refAuthor">Nottingham, M.</span>, <span class="refTitle">"Building Protocols with HTTP"</span>, <span class="seriesInfo">BCP 56</span>, <span class="seriesInfo">RFC 9205</span>, <span class="seriesInfo">DOI 10.17487/RFC9205</span>, <time datetime="2022-06" class="refDate">June 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9205">https://www.rfc-editor.org/info/rfc9205</a>&gt;</span>. </div>
</dd>
<dd class="break"></dd>
<dt id="BCP195">[BCP195]</dt>
      <dd>
<div class="refInstance">Best Current Practice 195, <span>&lt;<a href="https://www.rfc-editor.org/info/bcp195">https://www.rfc-editor.org/info/bcp195</a>&gt;</span>.<br><span>At the time of writing, this BCP comprises the following:</span>
</div>
<div class="refInstance" id="RFC7525">
            <span class="refAuthor">Sheffer, Y.</span>, <span class="refAuthor">Holz, R.</span>, and <span class="refAuthor">P. Saint-Andre</span>, <span class="refTitle">"Recommendations for Secure Use of Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)"</span>, <span class="seriesInfo">BCP 195</span>, <span class="seriesInfo">RFC 7525</span>, <span class="seriesInfo">DOI 10.17487/RFC7525</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7525">https://www.rfc-editor.org/info/rfc7525</a>&gt;</span>. </div>
<div class="refInstance" id="RFC8996">
            <span class="refAuthor">Moriarty, K.</span> and <span class="refAuthor">S. Farrell</span>, <span class="refTitle">"Deprecating TLS 1.0 and TLS 1.1"</span>, <span class="seriesInfo">BCP 195</span>, <span class="seriesInfo">RFC 8996</span>, <span class="seriesInfo">DOI 10.17487/RFC8996</span>, <time datetime="2021-03" class="refDate">March 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8996">https://www.rfc-editor.org/info/rfc8996</a>&gt;</span>. </div>
</dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="appendix-http-codes">
<section id="appendix-A">
      <h2 id="name-http-result-codes">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-http-result-codes" class="section-name selfRef">HTTP Result Codes</a>
      </h2>
<p id="appendix-A-1">The following table MAY be used as general guidance by IDMEFv2 systems acting
            as HTTP servers when mapping various error conditions to an appropriate HTTP
            result code.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<p id="appendix-A-2">Result codes other than the ones listed below MAY still be used,
            so long as their semantics match the requirements set in <a href="#protocol" class="auto internal xref">Section 4</a>.<a href="#appendix-A-2" class="pilcrow">¶</a></p>
<span id="name-mapping-error-conditions-to"></span><table class="center" id="table-1">
        <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-mapping-error-conditions-to" class="selfRef">Mapping error conditions to HTTP result codes</a>
        </caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">
              <p id="appendix-A-3.1.1.0.1">Error condition<a href="#appendix-A-3.1.1.0.1" class="pilcrow">¶</a></p>
</th>
            <th class="text-left" rowspan="1" colspan="1">
              <p id="appendix-A-3.1.1.0.1">HTTP result code<a href="#appendix-A-3.1.1.0.1" class="pilcrow">¶</a></p>
</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-A-3.2.1.1.1">No error<a href="#appendix-A-3.2.1.1.1" class="pilcrow">¶</a></p>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-A-3.2.1.2.1">2xx, usually 200 (OK) or 204 (No content)<a href="#appendix-A-3.2.1.2.1" class="pilcrow">¶</a></p>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-A-3.2.2.1.1">Malformed HTTP request (e.g. the HTTP request's body is not a valid
                                IDMEFv2 message)<a href="#appendix-A-3.2.2.1.1" class="pilcrow">¶</a></p>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-A-3.2.2.2.1">400 (Bad request)<a href="#appendix-A-3.2.2.2.1" class="pilcrow">¶</a></p>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-A-3.2.3.1.1">Unauthorized request (e.g. a request from an unauthorized IP address)<a href="#appendix-A-3.2.3.1.1" class="pilcrow">¶</a></p>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-A-3.2.3.2.1">403 (Forbidden)<a href="#appendix-A-3.2.3.2.1" class="pilcrow">¶</a></p>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-A-3.2.4.1.1">The HTTP request uses a method other than 'POST'<a href="#appendix-A-3.2.4.1.1" class="pilcrow">¶</a></p>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-A-3.2.4.2.1">405 (Method Not Allowed). In addition, the "Allow" HTTP response header
                                MUST be set accordingly when this code is used.<a href="#appendix-A-3.2.4.2.1" class="pilcrow">¶</a></p>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-A-3.2.5.1.1">Failure to negotiate the response's media type based on the "Accept"
                                HTTP request header.<a href="#appendix-A-3.2.5.1.1" class="pilcrow">¶</a></p>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-A-3.2.5.2.1">406 (Not Acceptable)<a href="#appendix-A-3.2.5.2.1" class="pilcrow">¶</a></p>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-A-3.2.6.1.1">Missing "Content-Length" request header in case the implementation
                                does not support the chunked transfer encoding<a href="#appendix-A-3.2.6.1.1" class="pilcrow">¶</a></p>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-A-3.2.6.2.1">411 (Length required), but please note that conforming implementations
                                are REQUIRED to support the chunked transfer encoding<a href="#appendix-A-3.2.6.2.1" class="pilcrow">¶</a></p>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-A-3.2.7.1.1">Exceedingly long IDMEFv2 message (e.g. the message is considered
                                to be too big due to size restrictions applied by an administrator)<a href="#appendix-A-3.2.7.1.1" class="pilcrow">¶</a></p>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-A-3.2.7.2.1">413 (Request entity too large)<a href="#appendix-A-3.2.7.2.1" class="pilcrow">¶</a></p>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-A-3.2.8.1.1">Unsupported serialization format<a href="#appendix-A-3.2.8.1.1" class="pilcrow">¶</a></p>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-A-3.2.8.2.1">415 (Unsupported media type)<a href="#appendix-A-3.2.8.2.1" class="pilcrow">¶</a></p>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-A-3.2.9.1.1">Internal server error<a href="#appendix-A-3.2.9.1.1" class="pilcrow">¶</a></p>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-A-3.2.9.2.1">500 (Internal server error)<a href="#appendix-A-3.2.9.2.1" class="pilcrow">¶</a></p>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-A-3.2.10.1.1">Unavailable service (e.g. the IDMEFv2 system is overloaded
                                or the next processing service is unavailable)<a href="#appendix-A-3.2.10.1.1" class="pilcrow">¶</a></p>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <p id="appendix-A-3.2.10.2.1">503 (Service unavailable)<a href="#appendix-A-3.2.10.2.1" class="pilcrow">¶</a></p>
</td>
          </tr>
        </tbody>
      </table>
</section>
</div>
<section id="appendix-B">
      <h2 id="name-transmission-examples">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-transmission-examples" class="section-name selfRef">Transmission examples</a>
      </h2>
<p id="appendix-B-1">In the examples below, "&gt;" denotes a request sent by the IDMEFv2 system
            acting as an HTTP client to an IDMEFv2 system acting as an HTTP server,
            while "&lt;" denotes a response to such requests.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<section id="appendix-B.1">
        <h3 id="name-acknowledged-idmefv2-messag">
<a href="#appendix-B.1" class="section-number selfRef">B.1. </a><a href="#name-acknowledged-idmefv2-messag" class="section-name selfRef">Acknowledged IDMEFv2 message</a>
        </h3>
<p id="appendix-B.1-1">In this example, the IDMEFv2 system acting as an HTTP server acknowledges
                the message sent by an IDMEFv2 system acting as an HTTP client.
                Because the HTTP server does not wish to send any content back to the client,
                it replies with HTTP result code 204 (No content), and both the "Content-Type"
                and "Content-Length" headers are omitted from the response.<a href="#appendix-B.1-1" class="pilcrow">¶</a></p>
<div class="lang-none sourcecode" id="appendix-B.1-2">
<pre>&gt; POST / HTTP/1.1\r\n
&gt; Host: idmefv2.example.com:TBD\r\n
&gt; Content-Type: application/json\r\n
&gt; Content-Length: 1234\r\n
&gt; Accept: application/json
&gt; \r\n
&gt; {"Version": "..."}

&lt; 204 No content\r\n
&lt; Connection: close\r\n
&lt; \r\n</pre><a href="#appendix-B.1-2" class="pilcrow">¶</a>
</div>
</section>
<section id="appendix-B.2">
        <h3 id="name-unsupported-serialization-f">
<a href="#appendix-B.2" class="section-number selfRef">B.2. </a><a href="#name-unsupported-serialization-f" class="section-name selfRef">Unsupported serialization format</a>
        </h3>
<p id="appendix-B.2-1">The following example illustrates the situation where an IDMEFv2 system acting
                as an HTTP client tries to send a message using a serialization format (media type)
                that is either not recognized or not supported by the IDMEFv2 system acting
                as an HTTP server.<a href="#appendix-B.2-1" class="pilcrow">¶</a></p>
<div class="lang-none sourcecode" id="appendix-B.2-2">
<pre>&gt; POST / HTTP/1.1\r\n
&gt; Host: idmefv2.example.com:TBD\r\n
&gt; Content-Type: application/x-idmefv2\r\n
&gt; Content-Length: 1234\r\n
&gt; Accept: application/json
&gt; \r\n
&gt; ...

&lt; 415 Unsupported media type\r\n
&lt; Connection: close\r\n
&lt; Content-Type: application/json\r\n
&lt; Content-Length: 61\r\n
&lt; \r\n
&lt; {"error": "Unsupported or unrecognized serialization format"}</pre><a href="#appendix-B.2-2" class="pilcrow">¶</a>
</div>
</section>
<section id="appendix-B.3">
        <h3 id="name-content-negotiation-failure">
<a href="#appendix-B.3" class="section-number selfRef">B.3. </a><a href="#name-content-negotiation-failure" class="section-name selfRef">Content negotiation failure</a>
        </h3>
<p id="appendix-B.3-1">In this example, the IDMEFv2 system acting as an HTTP client sends
                an IDMEFv2 message and requests that the server reponds using the
                "application/x-example-type" media type.<a href="#appendix-B.3-1" class="pilcrow">¶</a></p>
<p id="appendix-B.3-2">Since the server wishes to include details in the HTTP response
                but does not know how to generate a response using that media type,
                it sends back a page using HTTP result code 406 (Not acceptable).<a href="#appendix-B.3-2" class="pilcrow">¶</a></p>
<p id="appendix-B.3-3">The response's body may contain additional information about the media
                types the server is willing to use and the client may try to resend
                the request using one of the alternative media types presented inside
                the new HTTP request's "Accept" header.<a href="#appendix-B.3-3" class="pilcrow">¶</a></p>
<div class="lang-none sourcecode" id="appendix-B.3-4">
<pre>&gt; POST / HTTP/1.1\r\n
&gt; Host: idmefv2.example.com:TBD\r\n
&gt; Content-Type: application/json\r\n
&gt; Content-Length: 1234\r\n
&gt; Accept: application/x-example-type
&gt; \r\n
&gt; ...

&lt; 406 Not Acceptable\r\n
&lt; Connection: close\r\n
&lt; Content-Type: application/json\r\n
&lt; Content-Length: 111\r\n
&lt; \r\n
&lt; {"error": "Cannot reply using 'application/x-example-type'
  media type",\n"alternatives": ["application/json"]}\n</pre><a href="#appendix-B.3-4" class="pilcrow">¶</a>
</div>
</section>
</section>
<div id="authors-addresses">
<section id="appendix-C">
      <h2 id="name-authors-address">
<a href="#name-authors-address" class="section-name selfRef">Author's Address</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Gilles Lehmann</span></div>
<div dir="auto" class="left"><span class="org">Telecom Sud Paris</span></div>
<div dir="auto" class="left"><span class="country-name">France</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:gilles.lehmann@telecom-sudparis.eu" class="email">gilles.lehmann@telecom-sudparis.eu</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'92eecee09a1600a8',t:'MTc0NDQxOTg1MC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
